"use strict";(self.webpackChunkemilus=self.webpackChunkemilus||[]).push([[29],{8470:function(e,t,n){var a=n(1413),i=n(4236).Z.div((function(e){var t=e.justifyContent,n=e.alignItems,i=e.flexDirection,o=e.gap,s=e.padding,c=e.margin,l={display:"flex",justifyContent:t,alignItems:n,gap:"number"===typeof o?"".concat(o,"px"):o};return i&&(l.flexDirection=i),s&&(l.padding=s),c&&(l.margin=c),(0,a.Z)({},l)}));t.Z=i},7029:function(e,t,n){n.r(t),n.d(t,{GeofenceReport:function(){return Z}});var a=n(4165),i=n(5861),o=n(9439),s=n(2791),c=n(2999),l=n(1717),r=n(7888),d=n(7354),u=n(3248),m=n(8470),f=n(1730),h=n(3685),p=n(7007),x=n(6610),v=n(184),g=c.Z.Option,_=l.Z.RangePicker,Z=function(){var e=(0,s.useState)([]),t=(0,o.Z)(e,2),n=t[0],l=t[1],Z=(0,s.useState)(!1),j=(0,o.Z)(Z,2),Y=j[0],y=j[1],D=(0,s.useState)(null),I=(0,o.Z)(D,2),b=I[0],k=I[1],w=(0,s.useState)("All"),S=(0,o.Z)(w,2),M=S[0],A=S[1],C=(0,s.useState)([]),N=(0,o.Z)(C,2),P=N[0],G=N[1];(0,s.useEffect)((function(){function e(){return(e=(0,i.Z)((0,a.Z)().mark((function e(){var t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.ZP.get("vehicle_list");case 3:(t=e.sent).data.success?G(t.data.data):console.error("API request was not successful"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error fetching vehicle options:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var L=function(){var e=(0,i.Z)((0,a.Z)().mark((function e(){var t,i,s,c,r,d;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Selected Date Range:",b),b&&(t=(0,o.Z)(b,2),i=t[0],s=t[1],console.log("Start Date:",i.format("YYYY-MM-DD")),console.log("End Date:",s.format("YYYY-MM-DD"))),console.log("Selected Vehicle ID:",M),c={start_day:b?b[0].format("YYYY-MM-DD HH:mm:ss"):null,end_day:b?b[1].format("YYYY-MM-DD HH:mm:ss"):null,device_imei:"0"===M?null:M},l([]),y(!0),e.prev=6,e.next=9,p.ZP.post("geofence_report",c);case 9:r=e.sent,console.log(r.data),r.data&&Array.isArray(r.data.data)?(d=r.data.data.map((function(e){return{s_no:e.id,vehicle_name:e.vehicle_name,out_datetime:e.out_datetime,out_location:e.out_latitude+":"+e.out_longitude,in_datetime:e.in_datetime,in_location:e.in_latitude+":"+e.in_longitude,duration:e.distance}})),console.log(d),l(d),console.log("idleList:",n)):(l([]),console.log("Response data is not in the expected format:",r.data)),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(6),console.error(e.t0);case 17:y(!1);case 18:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(){return e.apply(this,arguments)}}(),E=[{title:"S.No",dataIndex:"s_no"},{title:"Vehicle Name",dataIndex:"vehicle_name"},{title:"Geofence Out Location",dataIndex:"out_location"},{title:"Geofence Out Time",dataIndex:"out_datetime"},{title:"Geofence In Location",dataIndex:"in_location"},{title:"Geofence In Time",dataIndex:"in_datetime"},{title:"Distance (kms))",dataIndex:"duration"},{title:"Map View",dataIndex:"map_view"}];return(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)(r.Z,{title:"Geofence Report",children:[(0,v.jsx)(m.Z,{alignItems:"center",justifyContent:"space-between",mobileFlex:!1,children:(0,v.jsxs)(m.Z,{className:"mb-1",mobileFlex:!1,children:[(0,v.jsx)("div",{className:"mr-md-3 mr-3",children:(0,v.jsx)(_,{showTime:!0,name:"range_picker",format:"YYYY-MM-DD hh:mm:ss",onChange:function(e){k(e)}})}),(0,v.jsx)("div",{className:"mr-md-3 mb-3",children:(0,v.jsxs)(c.Z,{defaultValue:"All",className:"w-100",style:{minWidth:180},name:"vehicle_id",placeholder:"Vehicle",onChange:function(e){A(e)},value:M,children:[(0,v.jsx)(g,{value:"All",children:"All"}),Array.isArray(P)?P.map((function(e){return(0,v.jsx)(g,{value:e.device_imei,children:e.vehicle_name},e.device_imei)})):(0,v.jsx)(g,{value:"Loading",children:"Loading..."})]})}),(0,v.jsx)("div",{className:"mb-3",children:(0,v.jsx)(d.ZP,{type:"primary",success:!0,icon:(0,v.jsx)(f.Z,{}),onClick:L,children:"Search"})}),(0,v.jsx)("div",{className:"mb-3",children:(0,v.jsx)(d.ZP,{type:"primary",icon:(0,v.jsx)(h.Z,{}),onClick:function(){(new x.i).addSheet("test").addColumns(E).addDataSource(n,{str2Percent:!0}).saveAs("Excel.xlsx")},children:"Export"})})]})}),(0,v.jsx)("div",{className:"table-responsive",children:Y?(0,v.jsx)("div",{children:"Loading..."}):n.length>0?(0,v.jsx)(u.Z,{bordered:!0,columns:E,dataSource:n}):(0,v.jsx)("p",{children:"No Data Found"})})]})})};t.default=Z}}]);
//# sourceMappingURL=29.80b926f5.chunk.js.map